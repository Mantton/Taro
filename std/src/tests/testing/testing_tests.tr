// Basic smoke test for the test harness: @test, @skip, @expectPanic.

@test
func testPasses() {
    std.testing.assertEqual(1 + 1, 2, "1 + 1 should be 2")
}

@test
@expectPanic
func testExpectPanic() {
    std.panic.panic("intentional")
}

@test
@expectPanic
func testAssertPanics() {
    std.assert(false, "assert should panic")
}

@test
@skip
func testSkipped() {
    std.testing.fail("should never run")
}

@cfg(profile("debug"))
func profileName() -> string {
    "debug"
}

@cfg(profile("release"))
func profileName() -> string {
    "release"
}

@test
func testDebugAssertProfileCfg() {
    let isDebug = #cfg(profile("debug"))
    let isRelease = #cfg(profile("release"))

    std.testing.assertTrue(
        isDebug || isRelease,
        "expected either debug or release profile cfg to be true",
    )
    std.testing.assertFalse(
        isDebug && isRelease,
        "debug and release profile cfg cannot both be true",
    )

    if isDebug {
        std.testing.assertTrue(
            std.string.stringEq(profileName(), "debug"),
            "profile-selected declaration should be debug variant",
        )
    } else {
        std.testing.assertTrue(
            std.string.stringEq(profileName(), "release"),
            "profile-selected declaration should be release variant",
        )
    }

    std.debugAssert(true, "debug assert should not panic")
}
