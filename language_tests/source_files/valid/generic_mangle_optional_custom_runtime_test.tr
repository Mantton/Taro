// TEST

import std.collections.List

struct Key {
    id: int32
}

@test
func genericMangleOptionalCustomRuntime() {
    var xs: List[Key?] = List()
    xs.append(.none)
    xs.append(.some(Key { id: 1 }))

    let first = xs.at(0)
    let second = xs.at(1)

    std.testing.assertTrue(first.isNone(), "first optional entry should be none")
    std.testing.assertTrue(second.isSome(), "second optional entry should be some")
    match second {
        case .some(value) => {
            std.testing.assertEqual(value.id, 1, "second optional payload mismatch")
        }
        case .none => {
            std.testing.assertFalse(true, "second optional payload unexpectedly missing")
        }
    }
}

func main() {}
