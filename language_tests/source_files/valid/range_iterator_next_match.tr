func expectSome(_ next: int32?, _ expected: int32, _ label: string) {
    match next {
        case .some(value) => {
            assert(value == expected, label)
        }
        case .none => {
            assert(false, "expected .some from range iterator")
        }
    }
}

func main() {
    let closed = 3..=5
    var iter = closed.makeIterator()

    expectSome(iter.next(), 3, "first value should be 3")
    expectSome(iter.next(), 4, "second value should be 4")
    expectSome(iter.next(), 5, "third value should be 5")

    match iter.next() {
        case .none => {}
        case .some(_) => {
            assert(false, "closed range iterator should be exhausted")
        }
    }

    let empty = 7..7
    var emptyIter = empty.makeIterator()
    match emptyIter.next() {
        case .none => {}
        case .some(_) => {
            assert(false, "empty exclusive range should yield no values")
        }
    }

    print("Range iterator next match ok\n")
}
