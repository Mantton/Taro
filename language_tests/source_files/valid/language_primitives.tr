// Tests: Variable declarations, type inference, literals (int, bool, rune, float),
//        function calls (non-overloaded and overloaded), unary/binary operators,
//        and if-else expressions.

func main() {
    usePlain()
    print("PASS: usePlain\n")
    
    useLocalIdentifier()
    print("PASS: useLocalIdentifier\n")
    
    useNonOverloadCall()
    print("PASS: useNonOverloadCall\n")
    
    useOverloadCall()
    print("PASS: useOverloadCall\n")
    
    useUnaryOperator()
    print("PASS: useUnaryOperator\n")
    
    useBinaryOperator()
    print("PASS: useBinaryOperator\n")
    
    useIfElse()
    print("PASS: useIfElse\n")
    
    print("All tests passed!\n")
}

// Plain
func usePlain() {
    let a = 10
    assert(a == 10, "int literal failed")
    
    let b: int32 = 10
    assert(b == 10, "explicit int32 failed")
    
    let c = true
    assert(c, "bool literal failed")
    
    let d = 'A'
    assert(d == 'A', "rune literal failed")
    
    let f = 1.0
    let e: double = 1.0
    // assert(f == e, "float equality failed") // Floats might be tricky directly
}

func useLocalIdentifier() {
    let a = true
    let b = a
    assert(b == true, "local identifier assignment failed")
}

// ==================================================

func useNonOverloadCall() {
    let a = use()
    assert(a == 'A', "simple call failed")
    
    let b: int32 = raise(value: a)
    assert(b == 0, "call with param -> int32 failed")
    
    let c: rune = raise(value: a)
    assert(c == 'A', "call with param -> rune failed")
}

func use() -> rune { return 'A' }
func raise(value: rune) -> rune { return value }
func raise(value: rune) -> int32 { return 0 }

// ==================================================
func useOverloadCall() {
    // Distinct By Param
    let x: uint8 = 10
    let a = take(value: x)
    assert(a == 10, "overload by param failed")
    
    let b = take()
    assert(b == 0, "overload no-arg failed")
}

func take() -> uint8 { return 0 }
func take(value: uint8) -> uint8 { return value }


// ==================================================
func useUnaryOperator() {
    let a = true
    let b = !a
    assert(b == false, "unary ! failed")
    let c = b
    assert(c == false, "assignment of negation failed")

    let a = 10
    let b = -10
    let c = -b
    assert(c == 10, "unary - failed")
    let d = c
    assert(d == 10, "assignment of negation failed")
}

func useBinaryOperator() {
    let a : usize = 1 + 1
    assert(a == 2, "binary + failed")
    let b = a
    assert(b == 2, "assignment of binary result failed")
}


// ====================================================
func useIfElse() {
    let a = 10
    let b = isGreaterThanZero(value: a)
    assert(b == true, "params check failed")

    let c = if b {
        'A'
    } else if a == 0 {
        'B'
    } else {
        'C'
    }
    assert(c == 'A', "if-else expression failed (taken branch)")
    
    let d = if false { 'A' } else { 'B' }
    assert(d == 'B', "if-else expression failed (else branch)")
}

func isGreaterThanZero(value: int32) -> bool {
    return value > 0
}
